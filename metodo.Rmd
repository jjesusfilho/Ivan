---
title: "Ivan"
author: "Ivan"
date: "7/10/2017"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```



# Metodologia


Para acessar os dados, utilizamos técnicas de raspagem de dados na internet (webscraping).  Essa técnica constitui-se na criação de um programa de computador, mais especificacamente, uma rotina de comandos, com a tarefa de acessar a página do Tribunal de Justiça do Distrito Federal e Baixar todos os dados. Essa rotina, função, roda no software R e pode ser acessada pelo [link](https://github.com/jjesusfilho/Ivan/blob/master/funcao_baixar_acordaos.R)  

Para a análise, foram baixados do Tribunal de Justiça do Distrito Federal 77.944 decisões sobre homicídio, roubo e tráfico de drogas. Esses crimes foram escolhidos porque compõem a maioria dos crimes que levam ao julgamento sobre a materialidade do crime e autoria. Depois disso, os dados foram manuseados e limpados para posterior análise. Foram mantidos somente os casos de apelação criminal. Além disso, como são poucos os casos anteriores a 1992, preferimos manter somente as decisões de 1992 a 2017. Ao final, o número baixou para 75.653 casos. Segue abaixo um gráfico com os respectivos valores ano a ano. 


```{r,echo=F,message=F}

df<-readRDS("~/R/Ivan/ivan/data/base_completa.rds")

df_turmas<-df[str_which(df$orgao_julgador,"\\d+"),]

unanimidade<-df_turmas %>% dplyr::count(ano,unanime)

unanimidade<-unanimidade %>% dplyr::group_by(ano) %>% 
  mutate(percentual=round(n*100/sum(n),digits=2))

df3<-df_turmas %>% filter(orgao_julgador=="3ª turma criminal")

una3<-df3 %>% dplyr::count(ano,unanime)

una3<-una3 %>% group_by(ano) %>% 
  mutate(percentual=round(n*100/sum(n),digits=3))

```

```{r}
library(ggplot2)
library(cowplot)
ggplot(unanimidade[unanimidade$ano>2009,],aes(x=as.factor(ano),y=n,group=unanime,fill=unanime))+
  geom_bar(stat="identity",position="dodge")+
   scale_fill_discrete(name="Votação",labels=c("Maioria","Unânime"),guide=guide_legend(reverse=T))+
  geom_text(aes(label=n),position=position_dodge(width=0.9), vjust=-0.25)+
  labs(x="anos",y="Percentual de votos",title="Votos das turmas criminais do Tribunal de Justiça do DF",caption="Fonte: TJDFT")+
  theme(
        legend.position = "bottom"
  )
  
```

## 

```{r,echo=F,message=F}
library(ggplot2)
library(cowplot)
ggplot(unanimidade,aes(x=as.factor(ano),y=percentual,group=unanime,color=unanime)) +
  geom_line()+
    scale_color_discrete(name="Votação",labels=c("Maioria","Unânime"),guide=guide_legend(reverse=T))+
  labs(x="anos",y="Percentual de votos",title="Votos das três turmas criminais do Tribunal de Justiça do DF",caption="Fonte: TJDFT")+
  #facet_wrap(~)
  theme_minimal()+
  theme(
    axis.text.x = element_text(angle=45,size=7),
    legend.position = "bottom"
  )

```


## Terceira Turma

A Terceira Turma foi criada em 2012. É a mais nova e aquela que apresenta mais clara variação nos dados.

```{r,echo=F,message=F}

ggplot(una3,aes(x=ano,y=percentual,group=unanime,color=unanime)) +
  geom_line()+
  scale_color_discrete(name="Votação",labels=c("Maioria","Unânime"),guide=guide_legend(reverse=T))+
  labs(x="anos",y="Percentual de votos",title="Votos da terceira turma criminal do Tribunal de Justiça do DF",caption="Fonte: TJDFT")+
  theme_minimal()+
  theme(
    axis.text.x = element_text(angle=45),
        legend.position = "bottom"

  )

```
